"use strict";var videos=document.querySelectorAll(".video"),inputs=document.querySelectorAll(".video-range__input"),muteButtons=document.querySelectorAll(".mute-button");function analyserInit(e){var t=new(window.AudioContext||window.webkitAudioContext),n=t.createMediaElementSource(e),o=t.createAnalyser();o.smoothingTimeConstant=.1,o.fftSize=32;var r=new Uint8Array(o.frequencyBinCount),i=e.parentNode&&e.parentNode.querySelector(".video-canvas"),a=e.parentNode&&e.parentNode.querySelector(".video-analyzer_block");if(i&&a){var s=i.getContext("2d");i&&a&&s&&(setInterval(function(){o.getByteFrequencyData(r);for(var e=0,t=0;t<r.length;t++)r[t]>e&&(e=r[t]);i.height=a.offsetHeight,s.clearRect(0,0,i.width,i.height),s.fillStyle="#fdf036",s.fillRect(0,0,30,e/2)},100),n.connect(o),o.connect(t.destination))}}inputs.forEach(function(e){var t=e.dataset,n=t.videoNum,o=t.type;if(n&&o){var r=n,i=store.getState()[r];e.value=i[o],e.nextElementSibling&&(e.nextElementSibling.textContent=i[o]+"%"),e.oninput=function(e){var t=e.target,n=t.dataset,o=n.videoNum,r=n.type;if(o&&r){var i=videos[parseInt(o,10)-1];t.nextElementSibling&&(t.nextElementSibling.textContent=t.value+"%"),"brightness"===r?store.dispatch({type:"CHANGE_BRIGHTNESS",payload:{num:o,brightness:t.value}}):"contrast"===r&&store.dispatch({type:"CHANGE_CONTRAST",payload:{num:o,contrast:t.value}});var a=o,s=store.getState()[a];i.style.filter="brightness("+s.brightness+"%) contrast("+s.contrast+"%)"}}}}),videos.forEach(function(e){analyserInit(e)}),muteButtons.forEach(function(e){var t=e.parentNode.previousElementSibling,n=t.dataset.videoNum;if(n){var o=n,r=store.getState()[o];t.muted=r.isMuted,e.textContent=r.isMuted?"off":"on",e.style.backgroundColor=r.isMuted?"red":"green",e.onclick=function(){store.dispatch({type:"CHANGE_MUTED",payload:{num:n}});var o=n,r=store.getState()[o];t.muted=r.isMuted,e.textContent=r.isMuted?"off":"on",e.style.backgroundColor=r.isMuted?"red":"green"}}});